<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>ProRails</title>
	<script src="dist/js/villa.min.js"></script>
	<link rel="stylesheet" href="dist/css/villa.min.css"/>
	<link rel="stylesheet" href="css/style.css"/>
	<!--[if lt IE 9]>
	<link rel="stylesheet" type="text/css" href="dist/css/material-colors.css"/>
	<link rel="stylesheet" type="text/css" href="dist/css/cross.css"/>
	<script src="dist/js/html5shiv.js"></script>
	<script src="dist/js/html5shiv-printshiv.js"></script>
	<script src="dist/js/classList.min.js"></script>
	<![endif]-->
</head>
<body class="font-grey-900">

<div id="providers"></div>
<div id="categories"></div>

<script src="dist/js/jquery-2.1.1.min.js"></script>
<script>

/**
 * Category
 */

	var destroyProvider;
	destroyProvider = function() {

	};


	var addProvider;
	addProvider = function(a, d) {
		var b = a.getElementsByTagName('ul')[0];
		b.appendChild(buildProvider(d));
	};


	var createProvider;
	createProvider = function() {

		var a = this.parentNode;
		var b = a.querySelector('input');

		$.ajax({
			cache: false,
			data: { name: b.value },
			method: 'get',
			url: 'i/provider/push/',
			success: function(data) {
				addProvider(a.parentNode, data);
			}
		});

	};


	var buildProviderInput;
	buildProviderInput = function() {

		var e = document.createElement('div');

		var input = document.createElement('input');
		input.id = 'providerInput';

		var a = document.createElement('a');
		a.innerHTML = 'Novo fornecedor';
		a.classList.add('btn');
		a.classList.add('new');
		a.addEventListener('click', createProvider);

		e.appendChild(input);
		e.appendChild(a);

		return e;

	};


	var buildProvider;
	buildProvider = function(d) {

		/*
		* It is simliar to build buildCategory function
		* */

		var li = document.createElement('li');
		var text = document.createTextNode(d.name);
		li.setAttribute('data-provider', d._id);
		li.appendChild(text);

		return li;

	};


	var buildProvidersList;
	buildProvidersList = function(d) {

		var e = document.createElement('ul');

		for (var i = d.length; i--; )
			e.appendChild(buildProvider(d[i].provider));

		return e;

	};


	var buildProviders;
	buildProviders = function(d) {
		destroyProvider();

		var b = document.getElementById('providers');

		b.insertBefore(buildProvidersList(d), b.firstChild);
		b.insertBefore(buildProviderInput(), b.firstChild);
	};


	var pullProvider;
	pullProvider = function() {
		$.ajax({
			cache: false,
			url: 'i/provider/pull/',
			success: function(data) {
				buildProviders(data);
			}
		});
	};


	var getProvider;
	getProvider = function() {
		pullProvider();
	};

	getProvider();



/**
 * Category
 */

	var destroyCategories;
	destroyCategories = function() {
		document.getElementById('categories').innerHTML = '';
	};

	var addCategory;
	addCategory = function(a, d) {
		var b = a.getElementsByTagName('ul')[0];
		b.appendChild(buildCategory(d));
	};

	var createCategory;
	createCategory = function() {

		var a = this.parentNode;
		var b = a.querySelector('input');

		$.ajax({
			cache: false,
			data: { name: b.value },
			method: 'get',
			url: 'i/category/push/',
			success: function(data) {
				addCategory(a.parentNode, data);
			}
		});

	};

	var buildCategoryInput;
	buildCategoryInput = function() {

		var e = document.createElement('div');

		var input = document.createElement('input');
		input.id = 'categoryInput';

		var a = document.createElement('a');
		a.innerHTML = 'Nova categoria';
		a.classList.add('btn');
		a.classList.add('new');
		a.addEventListener('click', createCategory);

		e.appendChild(input);
		e.appendChild(a);

		return e;

	};

	var buildCategory;
	buildCategory = function(d) {

		var li = document.createElement('li');
		var text = document.createTextNode(d.name);
		li.setAttribute('data-category', d._id);
		li.appendChild(text);

		return li;

	};

	var buildCategoriesList;
	buildCategoriesList = function(d) {

		var e = document.createElement('ul');

		for (var i = d.length; i--; )
			e.appendChild(buildCategory(d[i].category));

		return e;

	};

	var buildCategories;
	buildCategories = function(d) {

		destroyCategories();

		var b = document.getElementById('categories');

		b.insertBefore(buildCategoriesList(d), b.firstChild);
		b.insertBefore(buildCategoryInput(), b.firstChild);

	};

	var pullCategory;
	pullCategory = function() {
		$.ajax({
			cache: false,
			url: 'i/category/pull/',
			success: function(data) {
				buildCategories(data)
			}
		});
	};

	var getCategory;
	getCategory = function() {
		pullCategory();
	};

	getCategory();

</script>

</body>
</html>